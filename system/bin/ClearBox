#!/system/bin/sh
exec 2>>/dev/null
######
[ ! "$(whoami)" = "root" ] && echo " » Please use root privileges!" && exit 1
######
home="/data/adb/modules/wipe_cache"
######
RunService()
{
sh "$home/service.sh"
echo " » Done"
}
######
md_menu()
{
sh "$home/Menu.sh"
}
######
ClearCache()
{
sh "$home/all.sh" ClearAll &
wait
}
######
bin_dir()
{
if [ -d "/data/adb/magisk" ]; then
    echo "/data/adb/magisk"
elif [ -d "/data/adb/ap" ]; then
    echo "/data/adb/ap/bin"
elif [ -d "/data/adb/ksu" ]; then
    echo "/data/adb/ksu/bin"
else
    find -name busybox "/data/adb"
fi
}
######
home_dir()
{
echo "$home"
}
######
work_dir()
{
echo "/data/adb/wipe_cache"
}
######
version()
{
echo -e "ClearBox Version: $(grep "version=" "$home/module.prop" | cut -f2 -d '=')"
}
######
md_help()
{
echo "                             "
echo "Usage: ClearBox"
echo "                             "
echo "or ClearBox [ OPTION ]:"
echo "                             "
echo "    -u"
echo "           ~ Update Profile"
echo "                             "
echo "    -c"
echo "           ~ Clear All"
echo "                             "
echo "    -v"
echo "           ~ Version"
echo "                             "
echo "    -b"
echo "           ~ Busybox Bin Dir"
echo "                             "
echo "    -h"
echo "           ~ Module Home Dir"
echo "                             "
echo "    -w"
echo "           ~ Module Work Dir"
echo "                             "
echo "    --help"
echo "           ~ Module Help"
echo "                             "
}
######
case "$1" in
    *-h | *-H)
      home_dir
      ;;
    *-w | *-W)
      work_dir
      ;;
    *-b | *-B)
      bin_dir
      ;;
    *-u | *-U)
      RunService
      ;;
    *-c | *-C)
      ClearCache
      ;;
    *-v | *-V | *-version)
      version
      ;;
    *-help | *-HELP)
      md_help
      ;;
    *)
      md_menu
      ;;
esac

exit 0
